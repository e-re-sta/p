<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CitrusPortal</title>
<style>
  /* --- Reset & Darkmode --- */
  * { margin:0; padding:0; box-sizing:border-box; font-family:sans-serif; }
  body { background:#111; color:#eee; overflow:hidden; }
  a { color:inherit; text-decoration:none; }

  /* --- Container --- */
  #overlay { position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.95); z-index:9999; display:flex; flex-direction:column; align-items:center; justify-content:flex-start; padding:20px; }
  
  header { width:100%; display:flex; justify-content:space-between; align-items:center; margin-bottom:20px; }
  #reloadBtn { background:#ff6600; border:none; padding:10px 15px; color:#fff; font-weight:bold; cursor:pointer; border-radius:5px; }
  #connectWallet { background:#00ccff; border:none; padding:10px 15px; color:#000; font-weight:bold; cursor:pointer; border-radius:5px; }

  h1 { font-size:2rem; margin-bottom:10px; text-align:center; }

  /* --- Game Buttons --- */
  #gameContainer { display:grid; grid-template-columns: repeat(auto-fill,minmax(150px,1fr)); gap:15px; width:100%; max-width:1000px; margin-bottom:20px; }
  .gameBtn { background:#222; border:2px solid #555; border-radius:10px; padding:15px; cursor:pointer; text-align:center; transition:0.3s; font-weight:bold; color:#fff; }
  .gameBtn:hover { border-color:#ff6600; transform:scale(1.05); }

  /* --- Status Panel --- */
  #walletStatus { margin-bottom:20px; }

  /* --- Effects Canvas --- */
  #effectsCanvas { position:absolute; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:1; }

  /* --- Responsive --- */
  @media(max-width:600px){ #gameContainer { grid-template-columns: repeat(auto-fill,minmax(120px,1fr)); } }
</style>
</head>
<body>

<div id="overlay">
  <header>
    <button id="reloadBtn">Reload</button>
    <button id="connectWallet">Connect Wallet</button>
  </header>

  <h1>CitrusPortal</h1>
  <div id="walletStatus">Wallet: <span id="walletAddr">Not Connected</span></div>

  <div id="gameContainer">
    <!-- 12 Game Buttons -->
    <div class="gameBtn" data-game="1">Game 1</div>
    <div class="gameBtn" data-game="2">Game 2</div>
    <div class="gameBtn" data-game="3">Game 3</div>
    <div class="gameBtn" data-game="4">Game 4</div>
    <div class="gameBtn" data-game="5">Game 5</div>
    <div class="gameBtn" data-game="6">Game 6</div>
    <div class="gameBtn" data-game="7">Game 7</div>
    <div class="gameBtn" data-game="8">Game 8</div>
    <div class="gameBtn" data-game="9">Game 9</div>
    <div class="gameBtn" data-game="10">Game 10</div>
    <div class="gameBtn" data-game="11">Game 11</div>
    <div class="gameBtn" data-game="12">Game 12</div>
  </div>
</div>

<canvas id="effectsCanvas"></canvas>

<script>
/* ======= GLOBAL CONFIG ======= */
let walletAddress = ""; // <-- Hier einmal deine ETH/SOL Adresse eintragen
let walletConnected = false;

/* ======= PHANTOM / METAMASK CONNECT ======= */
const connectBtn = document.getElementById('connectWallet');
const walletSpan = document.getElementById('walletAddr');

connectBtn.addEventListener('click', async ()=>{
  if(window.solana && window.solana.isPhantom){
    try{
      const resp = await window.solana.connect();
      walletAddress = resp.publicKey.toString();
      walletConnected = true;
      walletSpan.textContent = walletAddress;
      alert("Phantom connected!");
    }catch(e){ console.error(e); alert("Connection failed"); }
  } else if(window.ethereum){
    try{
      const accounts = await window.ethereum.request({ method:'eth_requestAccounts' });
      walletAddress = accounts[0];
      walletConnected = true;
      walletSpan.textContent = walletAddress;
      alert("MetaMask connected!");
    }catch(e){ console.error(e); alert("Connection failed"); }
  } else {
    alert("No wallet detected!");
  }
});

/* ======= RELOAD BUTTON ======= */
document.getElementById('reloadBtn').addEventListener('click', ()=>{
  location.reload();
});

/* ======= GAME BUTTONS PLACEHOLDER ======= */
document.querySelectorAll('.gameBtn').forEach(btn=>{
  btn.addEventListener('click', ()=>{
    if(!walletConnected){ alert("Connect your wallet first!"); return; }
    const gameId = btn.dataset.game;
    alert("Game "+gameId+" clicked! Here you can load your game code.");
    // Platzhalter: hier kannst du Game-Code einfÃ¼gen oder ein iframe laden
  });
});

/* ======= EFFECTS CANVAS ======= */
const canvas = document.getElementById('effectsCanvas');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

window.addEventListener('resize', ()=>{
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
});

const effects = ["ranken","schnee","feuer","gurken","efeu"];
let effectIndex = 0;
let effectTimer = 0;

// --- Effekte Zyklus ---
function drawEffects(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  effectTimer++;
  if(effectTimer > 300){ // wechsel alle 5 Sekunden (60fps)
    effectTimer=0;
    effectIndex = (effectIndex+1) % effects.length;
  }
  const effect = effects[effectIndex];

  switch(effect){
    case "ranken":
      for(let i=0;i<10;i++){
        ctx.strokeStyle = "lime";
        ctx.beginPath();
        ctx.moveTo(Math.random()*canvas.width,canvas.height);
        ctx.lineTo(Math.random()*canvas.width,canvas.height - 50 - Math.random()*100);
        ctx.stroke();
      }
      break;
    case "schnee":
      for(let i=0;i<50;i++){
        ctx.fillStyle = "white";
        ctx.beginPath();
        ctx.arc(Math.random()*canvas.width, Math.random()*canvas.height, Math.random()*3,0,Math.PI*2);
        ctx.fill();
      }
      break;
    case "feuer":
      for(let i=0;i<30;i++){
        const x = Math.random()*canvas.width;
        const y = canvas.height - Math.random()*100;
        ctx.fillStyle = "orange";
        ctx.fillRect(x,y,4,20);
      }
      break;
    case "gurken":
      for(let i=0;i<15;i++){
        const x = Math.random()*canvas.width;
        const y = Math.random()*canvas.height;
        ctx.fillStyle = "green";
        ctx.fillRect(x,y,5,10);
      }
      break;
    case "efeu":
      for(let i=0;i<15;i++){
        const x = Math.random()*canvas.width;
        const y = canvas.height - Math.random()*150;
        ctx.strokeStyle = "darkgreen";
        ctx.beginPath();
        ctx.moveTo(x,y);
        ctx.lineTo(x+Math.random()*30,canvas.height);
        ctx.stroke();
      }
      break;
  }
  requestAnimationFrame(drawEffects);
}

drawEffects();
</script>
</body>
</html>
